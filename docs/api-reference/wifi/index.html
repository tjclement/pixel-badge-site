<!doctype html>
<html lang="en">
    <head>    
        <title>WiFi - Pixel Badge ESP32 LED devboard</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="The main site for Curious Supplies' Pixel Badge ESP32 WiFi-enabled LED devboard"/>
        <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%26display=swap" rel="stylesheet"> 
        <link rel="stylesheet" href="/assets/css/main.css">

        <meta property="og:title" content="WiFi - Pixel Badge ESP32 LED devboard" />
        <meta property="og:type" content="website" />
        <meta name="twitter:title" content="WiFi - Pixel Badge ESP32 LED devboard" />
        
        
        <meta name="twitter:card" content="summary" />
        
    </head>
    <body>
        
        <div id="page" class="site">
  <header id="masthead" class="site-header outer">
  <div class="inner">
    <div class="site-header-inside">
      <div class="site-branding">
        
        
        <p class="site-title"><a href="/">Pixel Badge</a></p>
        
      </div><!-- .site-branding -->
      
      
      <nav id="main-navigation" class="site-navigation" aria-label="Main Navigation">
        <div class="site-nav-inside">
          <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-close" aria-hidden="true"></span></button>
          <ul class="menu">
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/">
  
  Home
  
</a>

              
            </li>
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/docs">
  
  Docs
  
</a>

              
            </li>
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/blog">
  
  Blog
  
</a>

              
            </li>
          
            
            
            <li class="menu-item menu-button">
              
              
<a class="button" href="/#buy">
  
  Buy
  
</a>

              
            </li>
          
          </ul>
        </div><!-- .site-nav-inside -->
      </nav><!-- .site-navigation -->
      <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
      
    </div><!-- .site-header-inside -->
  </div><!-- .inner -->
</header><!-- .site-header -->

  <main id="content" class="site-content">
    <div class="inner outer">
  <div class="docs-content">
    
    




<nav id="docs-nav" class="docs-nav">
  <div id="docs-nav-inside" class="docs-nav-inside sticky">
    <button id="docs-nav-toggle" class="docs-nav-toggle">Navigate Docs<span class="icon-angle-right" aria-hidden="true"></span></button>
    <div class="docs-nav-menu">
      <ul id="docs-menu" class="docs-menu">
        <li class="docs-menu-item">
          <a href="/docs/">Welcome</a>
        </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/getting-started/">Getting Started</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/using/">Using your badge</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/connecting/">Connecting via USB</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/wifi/">Connecting to WiFi</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/install_apps/">Installing apps</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/app-development/">App Development</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/app-development/writing/">Writing your own apps</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/app-development/publishing/">Publishing your new app</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/app-development/tips/">Tips for making great apps</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children active">
            <a href="/docs/api-reference/">API Reference</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/buttons/">Buttons</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/rgb/">RGB</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/uinterface/">uInterface</a>
    </li>
  
    <li class="docs-menu-item current">
      <a href="/docs/api-reference/wifi/">WiFi</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/system/">System</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/appconfig/">Appconfig</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/valuestore/">Valuestore</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/audio/">Audio</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/sndmixer/">Sndmixer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/virtualtimers/">Virtualtimers</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/mpu6050/">MPU6050 Accelerometer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/dumbstreamjson/">DumbstreamJSON</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/consts/">Consts</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/micropython/">Micropython modules</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item">
            <a href="/docs/faq/">FAQ</a>
            
            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item">
            <a href="/docs/community/">Where To Get Support</a>
            
            
          </li>
        
      </ul><!-- .docs-menu -->
    </div><!-- .docs-nav-menu -->
  </div><!-- .docs-nav-inside -->
</nav><!-- .docs-nav -->

    <article class="post type-docs">
      <div class="post-inside">
        <header class="post-header">
          <h1 class="post-title line-left">WiFi</h1>
        </header><!-- .post-header -->
        <div class="post-content">
          <p>The <em>wifi</em> API allows you to connect to WiFi networks easily.</p>

<h2 id="example">Example</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import wifi
wifi.connect() # Connect to the WiFi network using the stored credentials
if not wifi.wait():
	print("Unable to connect to the WiFi network.")
else:
	print("You are now connected to WiFi!")
</code></pre></div></div>

<h2 id="reference">Reference</h2>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Parameters</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>connect</td>
      <td>[ssid], [password]</td>
      <td>Connect to a WiFi network. By default the stored credentials are used, but you can optionally provide the SSID (and password) of the network to connect to.</td>
    </tr>
    <tr>
      <td>disconnect</td>
      <td>-</td>
      <td>Disconnect from the WiFi network.</td>
    </tr>
    <tr>
      <td>status</td>
      <td>-</td>
      <td>Returns True if connected and False if not connected.</td>
    </tr>
    <tr>
      <td>wait</td>
      <td>[timeout]</td>
      <td>Wait until a connection with the WiFi network has been made or until the timeout time is reached. Timeout is in seconds but may be provided in 10ths of seconds. If no timeout is provided the default timeout is used. Returns True if connected after waiting and False if a connection could not be made before the timeout.</td>
    </tr>
    <tr>
      <td>ntp</td>
      <td>[only-if-needed], [server]</td>
      <td>Synchronize the Real-Time-Clock with the network. Normally the synchronisation is only started when the system clock has not yet been set since the last reset. This can be overruled by setting the only-if-needed parameter to False. By default the “‘pool.ntp.org” server pool is used.</td>
    </tr>
  </tbody>
</table>

<h2 id="wait-is-that-all-you-can-do-with-wifi">Wait, is that all you can do with WiFi?</h2>
<p>No, of course not. The whole network API from the mainline MicroPython project is available on the badge.team firmware.
Here are some examples for doing the stuff you’re probably looking for:</p>

<h3 id="connecting-to-a-wifi-network-the-hard-way">Connecting to a WiFi network, the hard way…</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">network</span><span class="p">,</span> <span class="n">machine</span><span class="p">,</span> <span class="n">time</span>

<span class="c1"># First we fetch the stored WiFi credentials
</span><span class="n">ssid</span> <span class="o">=</span> <span class="n">machine</span><span class="p">.</span><span class="n">nvs_getstr</span><span class="p">(</span><span class="s">"system"</span><span class="p">,</span> <span class="s">"wifi.ssid"</span><span class="p">)</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">machine</span><span class="p">.</span><span class="n">nvs_getstr</span><span class="p">(</span><span class="s">"system"</span><span class="p">,</span> <span class="s">"wifi.password"</span><span class="p">)</span>

<span class="c1"># Create the station (WiFi client) interface
</span><span class="n">sta_if</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">WLAN</span><span class="p">(</span><span class="n">network</span><span class="p">.</span><span class="n">STA_IF</span><span class="p">)</span>

<span class="c1"># Activate the station interface
</span><span class="n">sta_if</span><span class="p">.</span><span class="n">active</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Connect using the credentials
</span><span class="k">if</span> <span class="n">ssid</span> <span class="ow">and</span> <span class="n">password</span><span class="p">:</span>
	<span class="n">sta_if</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="c1"># Secured WiFi network
</span><span class="k">elif</span> <span class="n">ssid</span><span class="p">:</span> <span class="c1"># Password is None
</span>	<span class="n">sta_if</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">ssid</span><span class="p">)</span> <span class="c1"># Open WiFi network
</span><span class="k">else</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"ERROR: no SSID provided. Please configure WiFi (or manually set the variables at the top of this example)"</span><span class="p">)</span>

<span class="n">wait</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># 50x 100ms = 5 seconds
</span><span class="k">while</span> <span class="ow">not</span> <span class="n">sta_if</span><span class="p">.</span><span class="n">isconnected</span><span class="p">()</span> <span class="ow">and</span> <span class="n">wait</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
	<span class="n">wait</span> <span class="o">-=</span> <span class="mi">1</span>
	<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># Wait 100ms
</span>
<span class="k">if</span> <span class="n">sta_if</span><span class="p">.</span><span class="n">isconnected</span><span class="p">():</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"Connected!"</span><span class="p">)</span>
	<span class="n">ip_addr</span><span class="p">,</span> <span class="n">netmask</span><span class="p">,</span> <span class="n">gateway</span><span class="p">,</span> <span class="n">dns_server</span> <span class="o">=</span> <span class="n">sta_if</span><span class="p">.</span><span class="n">ifconfig</span><span class="p">()</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"My IP address is '{}', with netmask '{}'."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ip_addr</span><span class="p">,</span> <span class="n">netmask</span><span class="p">))</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"The gateway is at '{}' and the DNS server is at '{}'."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">gateway</span><span class="p">,</span> <span class="n">dns_server</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"Failed to connect to the WiFi network."</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="scanning-for-networks">Scanning for networks</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">network</span>
<span class="n">sta_if</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">WLAN</span><span class="p">(</span><span class="n">network</span><span class="p">.</span><span class="n">STA_IF</span><span class="p">)</span>
<span class="n">sta_if</span><span class="p">.</span><span class="n">active</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sta_if</span><span class="p">.</span><span class="n">scan</span><span class="p">()</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"SSID: {}, BSSID: {}. CHANNEL: {}, RSSI: {}, AUTHMODE: {} / {}, HIDDEN: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
</code></pre></div></div>
<h3 id="creating-an-access-point">Creating an access-point</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">network</span>
<span class="n">ap_if</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">WLAN</span><span class="p">(</span><span class="n">network</span><span class="p">.</span><span class="n">AP_IF</span><span class="p">)</span>
<span class="n">ap_if</span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="n">essid</span><span class="o">=</span><span class="s">"badgeNetwork"</span><span class="p">,</span> <span class="n">authmode</span><span class="o">=</span><span class="n">network</span><span class="p">.</span><span class="n">AUTH_WPA2_PSK</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">"helloworld"</span><span class="p">)</span> <span class="c1"># Create a network called "badgeNetwork" with password "helloworld"
</span><span class="n">ap_if</span><span class="p">.</span><span class="n">active</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Note: if you get “unknown error 0x000b” after running the config command then the password you chose is too short.</p>

<h2 id="more-information">More information</h2>
<p>We used the <a href="https://github.com/loboris/MicroPython_ESP32_psRAM_LoBo/wiki/network">loboris micropython fork (&lt;- link)</a> as the core of our badge firmware. The network API comes directly from his project.</p>

<p>The API looks a lot like the <a href="https://docs.micropython.org/en/latest/library/network.html">official MicroPython network API (&lt;- link)</a>.</p>

          
          
          
            
            
            
            
            
          
        </div><!-- .post-content -->
      </div><!-- .post-inside -->
    </article><!-- .post -->
    <nav id="page-nav" class="page-nav">
      <div id="page-nav-inside" class="page-nav-inside sticky">
        <h2 class="page-nav-title">Jump to Section</h2>
        <div id="page-nav-link-container"></div>
      </div><!-- .page-nav-inside -->
    </nav><!-- .page-nav -->
  </div><!-- .docs-content -->
</div><!-- .inner-->

  </main><!-- .site-content -->
  <footer id="colophon" class="site-footer outer">
  <div class="inner">
    <div class="site-footer-inside">
      <p class="site-info">
        
        
        <span class="copyright">Curious Supplies by Tom Clement</span>
        
        
          
          
<a class="" href="https://www.stackbit.com" target="_blank" rel="noopener">
  
  Made with Stackbit
  
</a>

        
      </p><!-- .site-info -->
      
      
      <div class="social-links">
        
          
          
<a class="button button-icon" href="https://twitter.com/Tom_Clement" target="_blank" rel="noopener">
  
  <span class="icon fab fa-twitter" aria-hidden="true"></span><span class="screen-reader-text">Twitter</span>
  
</a>

        
          
          
<a class="button button-icon" href="https://github.com/tjclement" target="_blank" rel="noopener">
  
  <span class="icon fab fa-github" aria-hidden="true"></span><span class="screen-reader-text">GitHub</span>
  
</a>

        
      </div><!-- .social-links -->
      
    </div><!-- .site-footer-inside -->
  </div><!-- .inner -->
  <!-- Privacy-first analytics, without cookies, multi-session tracking, and other evil nonsense -->
<script async defer data-domain="pixel.curious.supplies" src="https://plausible.io/js/plausible.js"></script>
</footer><!-- .site-footer -->

</div><!-- .site -->

        <!-- Scripts -->
        <script src="/assets/js/plugins.js"></script>
        <script src="/assets/js/main.js"></script>
        <script src="/assets/js/page-load.js"></script>
    </body> 
</html>
