<!doctype html>
<html lang="en">
    <head>    
        <title>Virtualtimers - Pixel Badge ESP32 LED devboard</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="The main site for Curious Supplies' Pixel Badge ESP32 WiFi-enabled LED devboard"/>
        <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%26display=swap" rel="stylesheet"> 
        <link rel="stylesheet" href="/assets/css/main.css">

        <meta property="og:title" content="Virtualtimers - Pixel Badge ESP32 LED devboard" />
        <meta property="og:type" content="website" />
        <meta name="twitter:title" content="Virtualtimers - Pixel Badge ESP32 LED devboard" />
        
        
        <meta name="twitter:card" content="summary" />
        
    </head>
    <body>
        
        <div id="page" class="site">
  <header id="masthead" class="site-header outer">
  <div class="inner">
    <div class="site-header-inside">
      <div class="site-branding">
        
        
        <p class="site-title"><a href="/">Pixel Badge</a></p>
        
      </div><!-- .site-branding -->
      
      
      <nav id="main-navigation" class="site-navigation" aria-label="Main Navigation">
        <div class="site-nav-inside">
          <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-close" aria-hidden="true"></span></button>
          <ul class="menu">
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/">
  
  Home
  
</a>

              
            </li>
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/docs">
  
  Docs
  
</a>

              
            </li>
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/blog">
  
  Blog
  
</a>

              
            </li>
          
            
            
            <li class="menu-item menu-button">
              
              
<a class="button" href="/#buy">
  
  Buy
  
</a>

              
            </li>
          
          </ul>
        </div><!-- .site-nav-inside -->
      </nav><!-- .site-navigation -->
      <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
      
    </div><!-- .site-header-inside -->
  </div><!-- .inner -->
</header><!-- .site-header -->

  <main id="content" class="site-content">
    <div class="inner outer">
  <div class="docs-content">
    
    




<nav id="docs-nav" class="docs-nav">
  <div id="docs-nav-inside" class="docs-nav-inside sticky">
    <button id="docs-nav-toggle" class="docs-nav-toggle">Navigate Docs<span class="icon-angle-right" aria-hidden="true"></span></button>
    <div class="docs-nav-menu">
      <ul id="docs-menu" class="docs-menu">
        <li class="docs-menu-item">
          <a href="/docs/">Welcome</a>
        </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/getting-started/">Getting Started</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/using/">Using your badge</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/connecting/">Connecting via USB</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/wifi/">Connecting to WiFi</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/getting-started/install_apps/">Installing apps</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/app-development/">App Development</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/app-development/writing/">Writing your own apps</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/app-development/publishing/">Publishing your new app</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/app-development/tips/">Tips for making great apps</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children active">
            <a href="/docs/api-reference/">API Reference</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/buttons/">Buttons</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/rgb/">RGB</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/uinterface/">uInterface</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/wifi/">WiFi</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/system/">System</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/appconfig/">Appconfig</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/valuestore/">Valuestore</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/audio/">Audio</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/sndmixer/">Sndmixer</a>
    </li>
  
    <li class="docs-menu-item current">
      <a href="/docs/api-reference/virtualtimers/">Virtualtimers</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/mpu6050/">MPU6050 Accelerometer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/dumbstreamjson/">DumbstreamJSON</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/consts/">Consts</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/api-reference/micropython/">Micropython modules</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item">
            <a href="/docs/faq/">FAQ</a>
            
            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item">
            <a href="/docs/community/">Where To Get Support</a>
            
            
          </li>
        
      </ul><!-- .docs-menu -->
    </div><!-- .docs-nav-menu -->
  </div><!-- .docs-nav-inside -->
</nav><!-- .docs-nav -->

    <article class="post type-docs">
      <div class="post-inside">
        <header class="post-header">
          <h1 class="post-title line-left">Virtualtimers</h1>
        </header><!-- .post-header -->
        <div class="post-content">
          <p>The <em>virtualtimers</em> module lets you regularly fire a function without holding up other Python logic. It is useful to update the screen for example, whilst keeping button presses low-latency. If you replace <code class="highlighter-rouge">time.sleep()</code> with functions called by virtualtimers, your app will feel much more snappy.</p>

<h2 id="reference">Reference</h2>

<div class="info">
Note: for historic reasons the parameter names mentioned here are not identical to the parameter names used in the code. This is to make them more understandable here. When calling these functions, it's therefore best to use positional arguments instead of named arguments. For example: virtualtimers.begin(100) instead of virtualtimers.begin(period=100) (the latter won't work).
</div>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Parameters</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>begin</td>
      <td>period</td>
      <td>Calling this function starts the virtualtimers task. It needs to be called only once in your app. The <code class="highlighter-rouge">period</code> parameter is the interval in ms in which functions can be called by virtualtimers. Setting it to 100ms for example, will allow functions to be called at any multiple of 100ms, but not quicker than that.</td>
    </tr>
    <tr>
      <td>stop</td>
      <td>-</td>
      <td>Stops the virtualtimers task. After calling this, you need to call <code class="highlighter-rouge">begin()</code> again when you want to use virtualtimers.</td>
    </tr>
    <tr>
      <td>new</td>
      <td>delay, callback</td>
      <td>Adds a new function callback to be executed after <code class="highlighter-rouge">delay</code> ms. <code class="highlighter-rouge">callback</code> should return after how many ms it want to be called again after executing. Note that <code class="highlighter-rouge">delay</code> canâ€™t be smaller than the <code class="highlighter-rouge">period</code> with which you called <code class="highlighter-rouge">begin()</code>.</td>
    </tr>
    <tr>
      <td>update</td>
      <td>period, callback</td>
      <td>Updates the function callback to be executed every <code class="highlighter-rouge">period</code> ms.</td>
    </tr>
  </tbody>
</table>

<h2 id="example">Example</h2>

<h3 id="updating-the-screen-every-x-ms">Updating the screen every X ms</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">virtualtimers</span><span class="p">,</span> <span class="n">rgb</span>

<span class="n">pixel_x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># This is the function we want to call regularly
</span><span class="k">def</span> <span class="nf">update_screen</span><span class="p">():</span>
    <span class="c1"># Show a black bar that cycles through the screen on every run
</span>    <span class="k">global</span> <span class="n">pixel_x</span>
    <span class="n">rgb</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">rgb</span><span class="p">.</span><span class="n">pixel</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">pixel_x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">pixel_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">pixel_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span>
    
    <span class="c1"># Let virtualtimers know that we want to run this function
</span>    <span class="c1"># again after 500 ms
</span>    <span class="n">next_execution</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># in ms
</span>    <span class="k">return</span> <span class="n">next_execution</span>


<span class="c1"># We set the default background colour to green
</span><span class="n">rgb</span><span class="p">.</span><span class="n">background</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="c1"># The timer is started with a minimum interval of 100ms
</span><span class="n">virtualtimers</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># and we tell it to execute update_screen immediately (no delay).
# Note that update_screen returns the number of ms until the next time
# it should run again.
</span><span class="n">virtualtimers</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">update_screen</span><span class="p">)</span>
</code></pre></div></div>

          
          
          
            
            
            
            
            
          
        </div><!-- .post-content -->
      </div><!-- .post-inside -->
    </article><!-- .post -->
    <nav id="page-nav" class="page-nav">
      <div id="page-nav-inside" class="page-nav-inside sticky">
        <h2 class="page-nav-title">Jump to Section</h2>
        <div id="page-nav-link-container"></div>
      </div><!-- .page-nav-inside -->
    </nav><!-- .page-nav -->
  </div><!-- .docs-content -->
</div><!-- .inner-->

  </main><!-- .site-content -->
  <footer id="colophon" class="site-footer outer">
  <div class="inner">
    <div class="site-footer-inside">
      <p class="site-info">
        
        
        <span class="copyright">Curious Supplies by Tom Clement</span>
        
        
          
          
<a class="" href="https://www.stackbit.com" target="_blank" rel="noopener">
  
  Made with Stackbit
  
</a>

        
      </p><!-- .site-info -->
      
      
      <div class="social-links">
        
          
          
<a class="button button-icon" href="https://twitter.com/Tom_Clement" target="_blank" rel="noopener">
  
  <span class="icon fab fa-twitter" aria-hidden="true"></span><span class="screen-reader-text">Twitter</span>
  
</a>

        
          
          
<a class="button button-icon" href="https://github.com/tjclement" target="_blank" rel="noopener">
  
  <span class="icon fab fa-github" aria-hidden="true"></span><span class="screen-reader-text">GitHub</span>
  
</a>

        
      </div><!-- .social-links -->
      
    </div><!-- .site-footer-inside -->
  </div><!-- .inner -->
  <!-- Privacy-first analytics, without cookies, multi-session tracking, and other evil nonsense -->
<script async defer data-domain="pixel.curious.supplies" src="https://plausible.io/js/plausible.js"></script>
</footer><!-- .site-footer -->

</div><!-- .site -->

        <!-- Scripts -->
        <script src="/assets/js/plugins.js"></script>
        <script src="/assets/js/main.js"></script>
        <script src="/assets/js/page-load.js"></script>
    </body> 
</html>
